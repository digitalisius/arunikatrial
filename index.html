<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dompet Keluarga - Aplikasi Pencatatan Keuangan</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="text-gray-800">

    <!-- Login Page -->
    <div id="login-page" class="flex items-center justify-center min-h-screen bg-gray-100">
        <div class="p-6 sm:p-8 bg-white rounded-xl shadow-lg w-full max-w-sm mx-4">
            <div class="text-center mb-6">
                <h1 id="logo-text-shiny" class="text-4xl font-extrabold tracking-tight mb-4">DOMPETMU</h1>
                <h2 class="text-xl font-bold text-gray-800" id="auth-title">Login ke Akun Anda</h2>
            </div>
            <div id="auth-error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded-lg mb-4 text-sm hidden"></div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="login-identifier" class="block text-sm font-medium text-gray-700 mb-1 text-left">Username atau Email</label>
                    <input type="text" id="login-identifier" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm">
                </div>
                <div>
                    <label for="login-password" class="block text-sm font-medium text-gray-700 mb-1 text-left">Password</label>
                    <input type="password" id="login-password" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm">
                </div>
                <button type="submit" class="auth-btn w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300">Login</button>
            </form>
            <form id="register-form" class="space-y-4 hidden">
                 <div>
                    <label for="register-username" class="block text-sm font-medium text-gray-700 mb-1 text-left">Username</label>
                    <input type="text" id="register-username" required pattern="^[a-zA-Z0-9_]{3,15}$" title="3-15 karakter, hanya huruf, angka, dan underscore (_)" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm">
                    <p class="text-xs text-gray-500 mt-1">Hanya huruf, angka, dan underscore (_). Tanpa spasi.</p>
                </div>
                <div>
                    <label for="register-email" class="block text-sm font-medium text-gray-700 mb-1 text-left">Email</label>
                    <input type="email" id="register-email" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm">
                </div>
                <div>
                    <label for="register-password" class="block text-sm font-medium text-gray-700 mb-1 text-left">Password (min. 6 karakter)</label>
                    <input type="password" id="register-password" required minlength="6" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm">
                </div>
                <button type="submit" class="auth-btn w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300">Daftar</button>
            </form>
            <p class="text-center text-sm text-gray-600 mt-6">
                <span id="login-prompt">Belum punya akun? <button id="show-register-btn" class="font-semibold text-indigo-600 hover:underline">Daftar di sini</button></span>
                <span id="register-prompt" class="hidden">Sudah punya akun? <button id="show-login-btn" class="font-semibold text-indigo-600 hover:underline">Login di sini</button></span>
            </p>
        </div>
    </div>

    <!-- App Container -->
    <div id="app-container" class="hidden container mx-auto p-2 sm:p-4 md:p-6 lg:p-8 max-w-5xl">
        <!-- Header for Desktop -->
        <header class="hidden md:flex bg-white/80 backdrop-blur-lg shadow-sm rounded-xl p-3 sm:p-4 mb-6 justify-between items-center sticky top-4 z-10 border border-gray-200/80">
            <div class="flex items-center space-x-3">
                <div id="user-initial" class="w-8 h-8 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-sm"></div>
                <h1 id="user-name" class="text-md font-bold text-gray-900"></h1>
            </div>
            <nav class="flex items-center space-x-1 md:space-x-2">
                <button onclick="window.app.showPage('beranda')" class="nav-btn group flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-semibold transition-all duration-300 text-gray-600 hover:bg-gray-100">
                    <i data-feather="home" class="w-4 h-4"></i>
                    <span>Beranda</span>
                </button>
                <button onclick="window.app.showPage('input')" class="nav-btn group flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-semibold transition-all duration-300 text-gray-600 hover:bg-gray-100">
                    <i data-feather="plus-circle" class="w-4 h-4"></i>
                    <span>Input Data</span>
                </button>
                <button onclick="window.app.showPage('laporan')" class="nav-btn group flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-semibold transition-all duration-300 text-gray-600 hover:bg-gray-100">
                    <i data-feather="file-text" class="w-4 h-4"></i>
                    <span>Laporan</span>
                </button>
                <button onclick="window.app.showPage('lainnya')" class="nav-btn group flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-semibold transition-all duration-300 text-gray-600 hover:bg-gray-100">
                    <i data-feather="more-horizontal" class="w-4 h-4"></i>
                    <span>Lainnya</span>
                </button>
                 <button id="logout-btn" class="group flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-semibold transition-all duration-300 text-red-500 hover:bg-red-50">
                    <i data-feather="log-out" class="w-4 h-4"></i>
                </button>
            </nav>
        </header>

        <main>
            <!-- ... existing main content ... -->
            <div id="beranda-page" class="page">
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80 mb-6">
                    <p id="motivational-message" class="text-center font-medium text-gray-700"></p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-200/80 transition-transform hover:scale-[1.02] duration-300">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 bg-green-100 rounded-full"><i data-feather="arrow-down-circle" class="text-green-600"></i></div>
                            <div><p class="text-sm text-gray-500">Total Pemasukan</p><p id="total-pemasukan" class="text-2xl font-bold text-gray-800">Rp 0</p></div>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-gray-200/80 transition-transform hover:scale-[1.02] duration-300">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 bg-red-100 rounded-full"><i data-feather="arrow-up-circle" class="text-red-600"></i></div>
                            <div><p class="text-sm text-gray-500">Total Pengeluaran</p><p id="total-pengeluaran" class="text-2xl font-bold text-gray-800">Rp 0</p></div>
                        </div>
                    </div>
                    <div id="saldo-card" class="bg-white p-5 rounded-xl shadow-sm border border-gray-200/80 transition-transform hover:scale-[1.02] duration-300 md:col-span-2 lg:col-span-1 cursor-pointer">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 bg-indigo-100 rounded-full"><i data-feather="briefcase" class="text-indigo-600"></i></div>
                            <div><p class="text-sm text-gray-500">Saldo Saat Ini</p><p id="saldo-saat-ini" class="text-2xl font-bold text-gray-800">Rp 0</p></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80 mb-6">
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-lg font-bold text-indigo-600">Tantangan Positif Hari Ini</h2>
                    </div>
                    <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-2 sm:space-y-0 sm:space-x-4">
                        <div class="flex items-center space-x-4">
                            <div class="p-3 bg-indigo-100 rounded-full"><i data-feather="award" class="w-6 h-6 text-indigo-600"></i></div>
                            <div>
                                <p id="challenge-message" class="text-sm font-medium text-gray-700">Tantangan harianmu akan muncul di sini!</p>
                            </div>
                        </div>
                        <button id="challenge-complete-btn" class="bg-green-500 hover:bg-green-600 text-white text-sm font-semibold py-2 px-4 rounded-full transition-colors duration-200" style="display: none;">
                            Selesai!
                        </button>
                    </div>
                    <p id="challenge-count" class="text-xs text-gray-500 mt-4">Anda telah menyelesaikan 0 tantangan.</p>
                </div>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80 mb-6">
                    <h2 class="text-lg font-bold">Konsistensi Pencatatan (7 Hari Terakhir)</h2>
                    <p class="text-sm text-gray-600 mb-2">Seberapa sering Anda mencatat dalam seminggu terakhir.</p>
                    <div id="consistency-tracker" class="flex justify-between items-center space-x-1 sm:space-x-2">
                    </div>
                </div>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80 mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold">Grafik Keuangan Bulanan</h2>
                        <div class="flex items-center space-x-2">
                            <button id="chart-prev-btn" class="chart-nav-btn p-1 rounded-full hover:bg-gray-100 transition-colors"><i data-feather="chevron-left" class="w-5 h-5 text-gray-600"></i></button>
                            <button id="chart-next-btn" class="chart-nav-btn p-1 rounded-full hover:bg-gray-100 transition-colors"><i data-feather="chevron-right" class="w-5 h-5 text-gray-600"></i></button>
                        </div>
                    </div>
                    <div class="relative h-80"><canvas id="financialChart"></canvas></div>
                </div>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80">
                    <h2 class="text-lg font-bold mb-4">Aktivitas Terakhir</h2>
                    <div id="recent-transactions-list" class="space-y-3"><p class="text-gray-500 text-center py-4">Belum ada aktivitas.</p></div>
                </div>
            </div>
            <div id="input-page" class="page hidden">
                 <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80">
                    <div class="flex border-b border-gray-200 mb-6">
                        <button id="pemasukan-tab" onclick="window.app.switchForm('pemasukan')" class="input-tab py-2 px-4 font-semibold border-b-2">Pemasukan</button>
                        <button id="pengeluaran-tab" onclick="window.app.switchForm('pengeluaran')" class="input-tab py-2 px-4 font-semibold border-b-2 text-gray-500">Pengeluaran</button>
                        <button id="transfer-tab" onclick="window.app.switchForm('transfer')" class="input-tab py-2 px-4 font-semibold border-b-2 text-gray-500">Transfer Dana</button>
                    </div>
                    
                    <form id="form-pemasukan" class="space-y-6">
                        <h2 class="text-lg font-bold text-green-600">Formulir Uang Masuk</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="pemasukan-tanggal" class="block text-sm font-medium text-gray-700 mb-1">Tanggal</label>
                                <input type="date" id="pemasukan-tanggal" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                            <div>
                                <label for="pemasukan-jumlah" class="block text-sm font-medium text-gray-700 mb-1">Jumlah (Rp)</label>
                                <input type="number" id="pemasukan-jumlah" placeholder="Contoh: 5000000" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                        </div>
                        <div>
                            <label for="pemasukan-keterangan" class="block text-sm font-medium text-gray-700 mb-1">Keterangan</label>
                            <input type="text" id="pemasukan-keterangan" placeholder="Contoh: Gaji bulanan" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="pemasukan-oleh" class="block text-sm font-medium text-gray-700 mb-1">Diterima Oleh</label>
                                <select id="pemasukan-oleh" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200"><option>Suami</option><option>Istri</option></select>
                            </div>
                            <div>
                                <label for="pemasukan-disimpan" class="block text-sm font-medium text-gray-700 mb-1">Disimpan di</label>
                                <input type="text" id="pemasukan-disimpan" placeholder="Contoh: Bank BCA, Gopay" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                        </div>
                        <div>
                            <label for="pemasukan-foto" class="block text-sm font-medium text-gray-700 mb-1">Upload Bukti (Opsional)</label>
                            <input type="file" id="pemasukan-foto" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-600 hover:file:bg-indigo-100 transition-all duration-200">
                            <img id="pemasukan-preview" class="mt-3 rounded-lg max-h-40 hidden border border-gray-200" />
                        </div>
                        <button type="submit" id="pemasukan-submit-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-[1.02] duration-300 focus:outline-none focus:ring-4 focus:ring-green-300 flex items-center justify-center space-x-2">
                            <span>Simpan Pemasukan</span>
                        </button>
                    </form>

                    <form id="form-pengeluaran" class="space-y-6 hidden">
                        <h2 class="text-lg font-bold text-red-600">Formulir Uang Keluar</h2>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="pengeluaran-tanggal" class="block text-sm font-medium text-gray-700 mb-1">Tanggal</label>
                                <input type="date" id="pengeluaran-tanggal" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                            <div>
                                <label for="pengeluaran-jumlah" class="block text-sm font-medium text-gray-700 mb-1">Jumlah (Rp)</label>
                                <input type="number" id="pengeluaran-jumlah" placeholder="Contoh: 150000" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                        </div>
                        <div>
                            <label for="pengeluaran-keterangan" class="block text-sm font-medium text-gray-700 mb-1">Keterangan</label>
                            <input type="text" id="pengeluaran-keterangan" placeholder="Contoh: Belanja bulanan" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="pengeluaran-kategori" class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
                                <select id="pengeluaran-kategori" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200"><option>Makanan & Minuman</option><option>Transportasi</option><option>Tagihan</option><option>Hiburan</option><option>Pendidikan</option><option>Kesehatan</option><option>Lainnya</option></select>
                            </div>
                            <div>
                                <label for="pengeluaran-dari-lokasi" class="block text-sm font-medium text-gray-700 mb-1">Dari Lokasi Dana</label>
                                <input type="text" id="pengeluaran-dari-lokasi" placeholder="Contoh: Bank BCA" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                        </div>
                        <div>
                            <label for="pengeluaran-oleh" class="block text-sm font-medium text-gray-700 mb-1">Dari Dana</label>
                            <select id="pengeluaran-oleh" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200"><option>Suami</option><option>Istri</option></select>
                        </div>
                        <div>
                            <label for="pengeluaran-foto" class="block text-sm font-medium text-gray-700 mb-1">Upload Nota (Opsional)</label>
                            <input type="file" id="pengeluaran-foto" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-600 hover:file:bg-indigo-100 transition-all duration-200">
                            <img id="pengeluaran-preview" class="mt-3 rounded-lg max-h-40 hidden border border-gray-200" />
                        </div>
                        <button type="submit" id="pengeluaran-submit-btn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-[1.02] duration-300 focus:outline-none focus:ring-4 focus:ring-red-300">Simpan Pengeluaran</button>
                    </form>

                    <form id="form-transfer" class="space-y-6 hidden">
                        <h2 class="text-lg font-bold text-blue-600">Formulir Transfer Dana</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="transfer-tanggal" class="block text-sm font-medium text-gray-700 mb-1">Tanggal</label>
                                <input type="date" id="transfer-tanggal" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                            <div>
                                <label for="transfer-jumlah" class="block text-sm font-medium text-gray-700 mb-1">Jumlah (Rp)</label>
                                <input type="number" id="transfer-jumlah" placeholder="Contoh: 500000" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="transfer-dari-oleh" class="block text-sm font-medium text-gray-700 mb-1">Dari Dana</label>
                                <select id="transfer-dari-oleh" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200"><option>Suami</option><option>Istri</option></select>
                            </div>
                            <div>
                                <label for="transfer-ke-oleh" class="block text-sm font-medium text-gray-700 mb-1">Ke Dana</label>
                                <select id="transfer-ke-oleh" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200"><option>Istri</option><option>Suami</option></select>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="transfer-dari" class="block text-sm font-medium text-gray-700 mb-1">Dari Lokasi</label>
                                <input type="text" id="transfer-dari" placeholder="Contoh: Bank BCA" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                            <div>
                                <label for="transfer-ke" class="block text-sm font-medium text-gray-700 mb-1">Ke Lokasi</label>
                                <input type="text" id="transfer-ke" placeholder="Contoh: Gopay" required class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                            </div>
                        </div>
                        <div>
                            <label for="transfer-keterangan" class="block text-sm font-medium text-gray-700 mb-1">Keterangan (Opsional)</label>
                            <input type="text" id="transfer-keterangan" placeholder="Contoh: Isi saldo Gopay" class="block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-3 text-sm transition-all duration-200">
                        </div>
                        <button type="submit" id="transfer-submit-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-[1.02] duration-300 focus:outline-none focus:ring-4 focus:ring-blue-300">Simpan Transfer</button>
                    </form>
                </div>
            </div>
            <div id="laporan-page" class="page hidden">
                 <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80">
                    <div class="flex flex-col md:flex-row justify-between items-start mb-6 gap-4">
                        <h2 class="text-lg font-bold">Laporan Bulanan</h2>
                        <div class="flex flex-col sm:flex-row sm:items-center gap-2 w-full sm:w-auto">
                            <select id="laporan-bulan" class="rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"></select>
                            <select id="laporan-tahun" class="rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"></select>
                            <button onclick="window.app.generateXLSX()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-3 rounded-lg flex items-center justify-center space-x-2 transition-all duration-300"><i data-feather="file" class="w-4 h-4"></i><span class="hidden sm:inline">Ekspor Excel</span></button>
                        </div>
                    </div>
                    <div id="laporan-content">
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 text-center">
                            <div class="bg-green-100/70 p-4 rounded-lg"><p class="text-sm text-green-700">Pemasukan</p><p id="laporan-pemasukan" class="text-lg font-bold text-green-800">Rp 0</p></div>
                            <div class="bg-red-100/70 p-4 rounded-lg"><p class="text-sm text-red-700">Pengeluaran</p><p id="laporan-pengeluaran" class="text-lg font-bold text-red-800">Rp 0</p></div>
                            <div class="bg-sky-100/70 p-4 rounded-lg"><p class="text-sm text-sky-700">Selisih</p><p id="laporan-selisih" class="text-lg font-bold text-sky-800">Rp 0</p></div>
                        </div>
                        <div class="overflow-x-auto">
                            <table id="laporan-tabel-container" class="w-full text-sm text-left text-gray-600">
                                <thead class="text-xs text-gray-700 uppercase bg-gray-50"><tr><th scope="col" class="px-6 py-3 rounded-l-lg">Tanggal</th><th scope="col" class="px-6 py-3">Keterangan</th><th scope="col" class="px-6 py-3">Tipe</th><th scope="col" class="px-6 py-3">Jumlah</th><th scope="col" class="px-6 py-3 text-center rounded-r-lg">Aksi</th></tr></thead>
                                <tbody id="laporan-tabel"></tbody>
                            </table>
                        </div>
                        <div id="pagination-container" class="mt-6 flex justify-center items-center space-x-2"></div>
                    </div>
                </div>
            </div>
             <!-- NEW "More" page -->
            <div id="lainnya-page" class="page hidden">
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-sm border border-gray-200/80">
                    <h2 class="text-xl font-bold mb-6 text-gray-800">Menu Lainnya</h2>
                    <div class="space-y-4">
                        <button onclick="window.app.showPage('dukungan')" class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-left">
                            <div class="flex items-center space-x-4">
                                <div class="p-2 bg-indigo-100 rounded-full"><i data-feather="gift" class="w-6 h-6 text-indigo-500"></i></div>
                                <div>
                                    <p class="font-semibold text-gray-700">Dukung Kami</p>
                                    <p class="text-sm text-gray-500">Bantu pengembangan aplikasi ini</p>
                                </div>
                            </div>
                            <i data-feather="chevron-right" class="w-5 h-5 text-gray-400"></i>
                        </button>
                        <button onclick="window.app.showPage('leaderboard')" class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-left">
                            <div class="flex items-center space-x-4">
                                <div class="p-2 bg-green-100 rounded-full"><i data-feather="bar-chart-2" class="w-6 h-6 text-green-500"></i></div>
                                <div>
                                    <p class="font-semibold text-gray-700">Leaderboard</p>
                                    <p class="text-sm text-gray-500">Lihat peringkat pengguna (segera hadir)</p>
                                </div>
                            </div>
                            <i data-feather="chevron-right" class="w-5 h-5 text-gray-400"></i>
                        </button>
                        <button onclick="window.app.showPage('review')" class="w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors duration-200 text-left">
                            <div class="flex items-center space-x-4">
                                <div class="p-2 bg-yellow-100 rounded-full"><i data-feather="star" class="w-6 h-6 text-yellow-500"></i></div>
                                <div>
                                    <p class="font-semibold text-gray-700">Kritik & Saran</p>
                                    <p class="text-sm text-gray-500">Beri kami masukan Anda</p>
                                </div>
                            </div>
                            <i data-feather="chevron-right" class="w-5 h-5 text-gray-400"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div id="dukungan-page" class="page hidden">
                 <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200/80">
                    <h2 class="text-2xl font-bold text-center mb-4 text-indigo-600">Dukung Pengembangan Aplikasi</h2>
                    <p class="text-center text-gray-600 mb-8 max-w-2xl mx-auto">
                        Aplikasi ini dikembangkan dengan cinta dan dedikasi. Jika Anda merasa aplikasi ini bermanfaat, Anda dapat memberikan dukungan melalui platform di bawah ini. Setiap dukungan Anda sangat berarti bagi kami untuk terus mengembangkan fitur-fitur baru. Terima kasih!
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center items-center gap-6">
                        <a href="https://saweria.co/" target="_blank" class="flex flex-col items-center p-6 bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-all duration-300 border border-yellow-200 w-full sm:w-auto">
                           <img src="https://user-images.githubusercontent.com/22780133/121803713-3ba62e80-cc64-11eb-8032-2d1265839b3b.png" alt="Saweria Logo" class="h-12 mb-3">
                           <span class="font-semibold text-yellow-800">Dukung via Saweria</span>
                        </a>
                        <a href="https://sociabuzz.com/" target="_blank" class="flex flex-col items-center p-6 bg-pink-50 hover:bg-pink-100 rounded-lg transition-all duration-300 border border-pink-200 w-full sm:w-auto">
                            <img src="https://sociabuzz.com/assets/img/sociabuzz_logo_platform_white.png" alt="Sociabuzz Logo" class="h-12 mb-3 bg-pink-500 p-2 rounded">
                           <span class="font-semibold text-pink-800">Dukung via Sociabuzz</span>
                        </a>
                    </div>
                </div>
            </div>
            <div id="leaderboard-page" class="page hidden">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200/80 text-center">
                    <i data-feather="bar-chart-2" class="w-16 h-16 mx-auto text-indigo-400 mb-4"></i>
                    <h2 class="text-2xl font-bold mb-2">Leaderboard</h2>
                    <p class="text-gray-600">Fitur ini sedang dalam pengembangan dan akan segera hadir. Nantikan!</p>
                </div>
            </div>
            <div id="review-page" class="page hidden">
                 <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200/80 text-center">
                    <i data-feather="star" class="w-16 h-16 mx-auto text-yellow-400 mb-4"></i>
                    <h2 class="text-2xl font-bold mb-2">Review & Ulasan</h2>
                    <p class="text-gray-600">Fitur untuk memberikan ulasan akan segera tersedia. Kami sangat menghargai masukan Anda!</p>
                </div>
            </div>
        </main>

        <!-- Bottom Nav for Mobile -->
        <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white shadow-[0_-2px_10px_rgba(0,0,0,0.08)] grid grid-cols-5 gap-1 p-2 z-20 rounded-t-2xl">
            <button onclick="window.app.showPage('beranda')" class="bottom-nav-btn flex flex-col items-center justify-center text-gray-600 hover:text-indigo-600 p-2 w-full rounded-lg">
                <i data-feather="home" class="w-5 h-5 mb-1"></i>
                <span class="text-xs font-medium">Beranda</span>
            </button>
            <button onclick="window.app.showPage('input')" class="bottom-nav-btn flex flex-col items-center justify-center text-gray-600 hover:text-indigo-600 p-2 w-full rounded-lg">
                <i data-feather="plus-circle" class="w-5 h-5 mb-1"></i>
                <span class="text-xs font-medium">Input</span>
            </button>
            <button onclick="window.app.showPage('laporan')" class="bottom-nav-btn flex flex-col items-center justify-center text-gray-600 hover:text-indigo-600 p-2 w-full rounded-lg">
                <i data-feather="file-text" class="w-5 h-5 mb-1"></i>
                <span class="text-xs font-medium">Laporan</span>
            </button>
            <button onclick="window.app.showPage('lainnya')" class="bottom-nav-btn flex flex-col items-center justify-center text-gray-600 hover:text-indigo-600 p-2 w-full rounded-lg">
                <i data-feather="menu" class="w-5 h-5 mb-1"></i>
                <span class="text-xs font-medium">Lainnya</span>
            </button>
            <button id="logout-btn-mobile" class="bottom-nav-btn flex flex-col items-center justify-center text-gray-600 hover:text-red-600 p-2 w-full rounded-lg">
                <i data-feather="log-out" class="w-5 h-5 mb-1"></i>
                <span class="text-xs font-medium">Keluar</span>
            </button>
        </nav>
    </div>

    <!-- Modals -->
    <!-- ... existing modals ... -->
    <div id="detail-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto p-6 relative animate-scale-in">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700"><i data-feather="x" class="w-6 h-6"></i></button>
            <h3 class="text-xl font-bold mb-4 text-gray-800" id="modal-title"></h3>
            <div id="modal-body" class="space-y-3 text-sm border-b pb-4 mb-4"></div>
            <div class="mt-4"><p class="text-sm font-medium text-gray-700 mb-2">Bukti Transaksi:</p><img id="modal-image" src="" class="rounded-lg w-full h-auto object-contain border" alt="Bukti Transaksi"></div>
        </div>
    </div>
    
    <div id="popup-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-sm p-6 text-center animate-scale-in">
            <div id="popup-loader" class="mx-auto mb-4 loader w-12 h-12 rounded-full border-4 border-gray-200 hidden"></div>
            <div id="popup-icon" class="mx-auto mb-4"></div>
            <h3 class="text-xl font-bold mb-2 text-gray-800" id="popup-title"></h3>
            <p class="text-gray-600 mb-6" id="popup-message"></p>
            <div id="popup-button-container" class="flex items-center gap-3"></div>
        </div>
    </div>
    
    <div id="report-sort-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-sm p-6 relative animate-scale-in text-center">
            <h3 class="text-xl font-bold mb-4 text-gray-800">Urutkan Laporan Berdasarkan</h3>
            <p class="text-sm text-gray-600 mb-6">Pilih cara pengurutan data laporan yang Anda inginkan.</p>
            <div class="flex flex-col gap-4">
                <button id="sort-by-created-at-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300">
                    Tanggal Input (Terbaru)
                </button>
                <button id="sort-by-tanggal-btn" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-4 rounded-lg transition-all duration-300">
                    Tanggal Transaksi
                </button>
            </div>
            <button id="close-sort-modal-btn" class="mt-4 text-sm text-gray-500 hover:underline">Batal</button>
        </div>
    </div>

    <div id="balance-breakdown-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-sm p-6 relative animate-scale-in">
            <button id="close-balance-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700"><i data-feather="x" class="w-6 h-6"></i></button>
            <h3 class="text-xl font-bold mb-4 text-gray-800">Rincian Saldo per Lokasi</h3>
            <p class="text-sm text-gray-500 mb-4">Menghitung total dana berdasarkan pemasukan, pengeluaran, dan perpindahan dana yang tercatat.</p>
            <div id="balance-breakdown-list" class="space-y-3 max-h-60 overflow-y-auto">
            </div>
        </div>
    </div>
    
    <footer class="text-center p-4 text-xs text-gray-400">
        Powered by Arunika Group 2025
    </footer>
    
    <!-- Main App Logic -->
    <script type="module" src="js/main.js"></script>
</body>
</html>

